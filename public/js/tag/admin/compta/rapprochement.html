<rapprochement>
<div if={ COMPTA_READ } class="content with_submenu rapprochement_bancaire">
	<div class="rapprochement_bleu"><p class="texte">Rapprochement Bancaire</p></div>

	<div class="slide-up"> 
		<div class="line-separator"></div>


		<fieldset class="filtres">
			<legend class="left">Filtres</legend>
			<div class="cell_1"> 
				<div class="filtreJournauxComptes"> 
    					<label class="filtre_journal" for="">Journaux</label> 
    					<select name="filtre_budget" id="filtre_journal" class="xxl_input"> 
    						<option value=""></option> 
    						<option value="3">Banque si asc</option>
    						<option value="11">cccccc</option>
    						<option value="6">ffff</option>
    						<option value="8">operations</option>
    						<option value="7">test</option>
    						<option value="10">test</option>
    						<option value="1">test1</option>
    						<option value="9">ttttttt</option> 
    					</select> 
    					<label class="filtres_comptes" for="filtre_compte">Comptes</label> 
    					<select name="filtre_compte" id="filtre_compte" class="xxl_input"> 
    						<option value=""></option>
    						<option value="26">10205500 test7</option>
    						<option value="27">10212200 testbbb</option>
    						<option value="28">102211 yyyyy</option>
    						<option value="4">10222222 ggggggg</option>
    						<option value="23">10223456 test</option>
    						<option value="17">1046666 toto test</option>
    						<option value="2">105555 ddddd</option>
    						<option value="20">21123456 test in 21</option>
    						<option value="22">5166666 trefdsds</option>
    						<option value="21">5355555 </option>
    						<option value="18">60123456 compte de test</option>
    						<option value="12">604000 Achat sur Prestations</option>
    						<option value="9">604000 Achat sur Prestations</option>
    						<option value="10">604000 Achat sur Prestations</option>
    						<option value="11">604000 Achat sur Prestations</option>
    						<option value="15">604000 Achat sur Prestations</option>
    						<option value="16">604000 test olivier</option>
    						<option value="13">604000 Achat sur Prestations</option>
    						<option value="14">604000 Achat sur Prestations</option>
    						<option value="25">60454545 gfsdgfsd</option>
    						<option value="19">60456789 test compte 2</option>
    						<option value="24">70452145 vdwvfd</option> 
    					</select> 
                   
				</div> 
				<div class="filtreJournauxComptes"> 
                        <label class="label_budget" for="filtre_journal">Budget</label> 
                        <select name="filtre_journal" id="filtre_journal" class="xxl_input"> 
                            <option value=""></option> 
                            <option value="3">Banque si asc</option>
                            <option value="11">cccccc</option>
                            <option value="6">ffff</option>
                            <option value="8">operations</option>
                            <option value="7">test</option>
                            <option value="10">test</option>
                            <option value="1">test1</option>
                            <option value="9">ttttttt</option> 
                        </select> 
                        <label class="filtres_analytique" for="filtre_compte">Analytique</label> 
                        <select name="filtre_compte" id="filtre_compte" class="xxl_input"> 
                            <option value=""></option>
                            <option value="26">10205500 test7</option>
                            <option value="27">10212200 testbbb</option>
                            <option value="28">102211 yyyyy</option>
                            <option value="4">10222222 ggggggg</option>
                            <option value="23">10223456 test</option>
                            <option value="17">1046666 toto test</option>
                            <option value="2">105555 ddddd</option>
                            <option value="20">21123456 test in 21</option>
                            <option value="22">5166666 trefdsds</option>
                            <option value="21">5355555 </option>
                            <option value="18">60123456 compte de test</option>
                            <option value="12">604000 Achat sur Prestations</option>
                            <option value="9">604000 Achat sur Prestations</option>
                            <option value="10">604000 Achat sur Prestations</option>
                            <option value="11">604000 Achat sur Prestations</option>
                            <option value="15">604000 Achat sur Prestations</option>
                            <option value="16">604000 test olivier</option>
                            <option value="13">604000 Achat sur Prestations</option>
                            <option value="14">604000 Achat sur Prestations</option>
                            <option value="25">60454545 gfsdgfsd</option>
                            <option value="19">60456789 test compte 2</option>
                            <option value="24">70452145 vdwvfd</option> 
                        </select> 
                   
                </div> 
				<div class="filtreJournauxComptes"> 
                        <label class="" for="filtre_journal">Fournisseurs</label> 
                        <select name="filtre_journal" id="filtre_journal" class="xxl_input"> 
                            <option value=""></option> 
                            <option value="3">Banque si asc</option>
                            <option value="11">cccccc</option>
                            <option value="6">ffff</option>
                            <option value="8">operations</option>
                            <option value="7">test</option>
                            <option value="10">test</option>
                            <option value="1">test1</option>
                            <option value="9">ttttttt</option> 
                        </select> 
                        <label class="filtres_adherents" for="filtre_compte">Adhérents</label> 
                        <select name="filtre_compte" id="filtre_compte" class="xxl_input"> 
                            <option value=""></option>
                            <option value="26">10205500 test7</option>
                            <option value="27">10212200 testbbb</option>
                            <option value="28">102211 yyyyy</option>
                            <option value="4">10222222 ggggggg</option>
                            <option value="23">10223456 test</option>
                            <option value="17">1046666 toto test</option>
                            <option value="2">105555 ddddd</option>
                            <option value="20">21123456 test in 21</option>
                            <option value="22">5166666 trefdsds</option>
                            <option value="21">5355555 </option>
                            
                            <option value="15">604000 Achat sur Prestations</option>
                            <option value="16">604000 test olivier</option>
                            <option value="13">604000 Achat sur Prestations</option>
                            <option value="14">604000 Achat sur Prestations</option>
                            <option value="25">60454545 gfsdgfsd</option>
                            <option value="19">60456789 test compte 2</option>
                            <option value="24">70452145 vdwvfd</option> 
                        </select> 
                   
                </div> 
			</div>
			<div class="cell_2">
				<div class="ecritures_non_validees"> 
					<input type="checkbox" id="ec_valides" >
					Ecritures Non Validées   
				</div> 
				<div class="ecritures_validees"> 
					<input type="checkbox" id="">
					<span>Ecritures Validées</span> 
				</div> 
				<div class="ecritures_du_jour"> 
					<input type="checkbox" id="ec_non_valides">
					<span>Ecritures du Jour</span> 
				</div> 
				<div class="operation"> 
					<span class="numero_operation">N° Opération</span>
					<input type="text" id="" size="10" maxlength="10" class="input_operation"> 
				</div>
			</div>
			<div class="cell_3"> 
				<div class="ecritures_lettrees"> 
					<input type="checkbox" id="">
					<span>Ecritures Lettrées</span> 
				</div> 
				<div class="ecritures_non_lettrees"> 
					<input type="checkbox" id="">
					<span>Ecritures Non Lettrées</span> 
				</div> 
				<div class="date"> 
					<span>Date</span>
					<input type="text" class="input_date" id="" size="7" maxlength="4" >
					<input type="text" class="input_date" id="" size="7" maxlength="4"> 
				</div>

				<div class="numero_piece"> 
					<span class="span_piece">N° Pièce</span>
					<input type="text" class="input_piece" size="8" maxlength="8"> 
				</div>
			</div>
		</fieldset>


		<div class="compte_middle">
			<div class="compte"> 
				<label for="Compte">Compte</label>
				<select name="compte" class="input_compte" id="" size="0" >
					<option value="" disabled selected>Choisir un compte</option>
					<option value="richard">richard</option>
					<option value="dupont">dupont</option>
				</select>
			</div>
			<div class="solde_bancaire">Solde Bancaire
				<input type="text" class="input_solde" name=""   size="10" maxlength="10"/>
			</div>
			<div class="mois">Mois
				<input type="text" class="input_mois_annee" name=""  size="4" maxlength="2" />
			</div>
			<div class="annee">Année
				<input type="text" class="input_mois_annee" name=""  size="5" maxlength="4" />
			</div>

			<div class="numéro_rapprochement">N° de rapprochement
				<input type="text" name="" class="numero_rappro" size="7" maxlength="4" />
			</div>
		</div>

		<div class="contenaire_solde">
			<button name="save_submit" class="blue save_submit" type="submit">Enregistrer</button>				
			<div class="solde">
				<div class="solde_theo"> Solde Théorique 
					<input type="text" name="" class="input_solde"   size="10" maxlength="10"/>
				</div>
				<div class="solde_reel"> Solde Réel 
					<input type="text" class="input_solde" name=""   size="10" maxlength="10"/>
				</div>
			</div>
			<div class="solde2">
				<div class="solde_debit"> 
					<div>
						<span class="title">Solde Débit</span></div> 
						<div>
							<span class="montant">0.00 </span>
							<span class="euro">€</span>
						</div> 
					</div><div class="solde_credit"> 
						<div>
							<span class="title">Solde Crédit </span>
						</div> 
						<div>
							<span class="montant">0.00 
							</span>
							<span class="euro">€</span>
						</div> 
					</div><div class="ecart"> 
						<div>
							<span class="title">Ecart </span>
						</div> 
						<div>
							<span class="montant">0.00 
							</span>
							<span class="euro">€</span>
						</div> 
					</div>
				</div>
			</div>
		</div>
        <div class="tableau_operations">
            <div class="cell_tableau1" >
                <div class="sous_cell_compte">Compte
                </div>
                <div class="sous_cell_debit">Débit
                </div>
                <div class="sous_cell_credit">Crédit
                </div>
                <div class="sous_cell_rappro">Rapprochement
                </div>
            </div>
            <div class="cell_tableau2" >
                <div class="sous_cell_banque">
                    <span> Banque BNP</span>
                </div>
                <div class="sous_cell_libelle">
                    <span> Réglement Chèque 35165456 </span>
                </div>
                <div class="sous_cell_type">
                    <span> ANCV - Chèques Vacances</span>
                </div>
                <div class="sous_cell_image">
                     <img class="" src="/img/visible_oeil.png" 
                   alt="oeil">
                </div>
                <div class="sous_cell_montant_debit">
                <span> 12 000.00</span>
                </div>
                <div class="sous_cell_montant_credit">
              
                </div>
                 <div class="sous_cell_rappro">
                <input type="checkbox">
                </div>
            </div>
        <div class="cell_tableau2" >
                <div class="sous_cell_banque">
                    <span> Banque BNP</span>
                </div>
                <div class="sous_cell_libelle">
                    <span> Réglement Chèque 35165456 </span>
                </div>
                <div class="sous_cell_type">
                    <span> ANCV - Chèques Vacances</span>
                </div>
                <div class="sous_cell_image">
                   <img class="" src="/img/visible_oeil.png" 
                   alt="oeil">
                </div>
                <div class="sous_cell_montant_debit">
                <span> 12 000.00</span>
                </div>
                <div class="sous_cell_montant_credit">
              
                </div>
                 <div class="sous_cell_rappro">
                <input type="checkbox">
                </div>
            </div>
            <div class="cell_tableau2" >
                <div class="sous_cell_banque">
                    <span> Banque BNP</span>
                </div>
                <div class="sous_cell_libelle">
                    <span> Réglement Chèque 35165456 </span>
                </div>
                <div class="sous_cell_type">
                    <span> ANCV - Chèques Vacances</span>
                </div>
                <div class="sous_cell_image">
                     <img class="" src="/img/visible_oeil.png" 
                   alt="oeil">
                </div>
                <div class="sous_cell_montant_debit">
                <span> 12 000.00</span>
                </div>
                <div class="sous_cell_montant_credit">
              
                </div>
                 <div class="sous_cell_rappro">
                <input type="checkbox">
                </div>
            </div>
            <div class="cell_tableau2" >
                <div class="sous_cell_banque">
                    <span> Banque BNP</span>
                </div>
                <div class="sous_cell_libelle">
                    <span> Réglement Chèque 35165456 </span>
                </div>
                <div class="sous_cell_type">
                    <span> ANCV - Chèques Vacances</span>
                </div>
                <div class="sous_cell_image">
                    <span> </span>
                </div>
                <div class="sous_cell_montant_debit">
                    <span> 12 000.00</span>
                </div>
                <div class="sous_cell_montant_credit">
              
                </div>
                 <div class="sous_cell_rappro">
                <input type="checkbox">
                </div>
            </div>
            <div class="cell_tableau2" >
                <div class="sous_cell_banque">
                    <span> Banque BNP</span>
                </div>
                <div class="sous_cell_libelle">
                    <span> Réglement Chèque 35165456 </span>
                </div>
                <div class="sous_cell_type">
                    <span> ANCV - Chèques Vacances</span>
                </div>
                <div class="sous_cell_image">
                    <span> </span>
                </div>
                <div class="sous_cell_montant_debit">
                <span> 12 000.00</span>
                </div>
                <div class="sous_cell_montant_credit">
              
                </div>
                 <div class="sous_cell_rappro">
                <input type="checkbox">
                </div>
            </div>
            <div class="cell_tableau2" >
                <div class="sous_cell_banque">
                    <span> Banque BNP</span>
                </div>
                <div class="sous_cell_libelle">
                    <span> Réglement Chèque 35165456 </span>
                </div>
                <div class="sous_cell_type">
                    <span> ANCV - Chèques Vacances</span>
                </div>
                <div class="sous_cell_image">
                    <span> </span>
                </div>
                <div class="sous_cell_montant_debit">
                    <span> 12 000.00</span>
                </div>
                <div class="sous_cell_montant_credit">
              
                </div>
                 <div class="sous_cell_rappro">
                    <input type="checkbox">
                </div>
            </div>
            <div class="cell_tableau2" >
                <div class="sous_cell_banque">
                    <span> Banque BNP</span>
                </div>
                <div class="sous_cell_libelle">
                    <span> Réglement Chèque 35165456 </span>
                </div>
                <div class="sous_cell_type">
                    <span> ANCV - Chèques Vacances</span>
                </div>
                <div class="sous_cell_image">
                    <span> </span>
                </div>
                <div class="sous_cell_montant_debit">
                    <span> 12 000.00</span>
                </div>
                <div class="sous_cell_montant_credit">
              
                </div>
                <div class="sous_cell_rappro">
                    <input type="checkbox">
                </div>
            </div>
            <div class="cell_tableau2" >
                <div class="sous_cell_banque">
                    <span> Banque BNP</span>
                </div>
                <div class="sous_cell_libelle">
                    <span> Réglement Chèque 35165456 </span>
                </div>
                <div class="sous_cell_type">
                    <span> ANCV - Chèques Vacances</span>
                </div>
                <div class="sous_cell_image">
                    <span> </span>
                </div>
                <div class="sous_cell_montant_debit">
                    <span> 12 000.00</span>
                </div>
                <div class="sous_cell_montant_credit">
              
                </div>
                 <div class="sous_cell_rappro">
                    <input type="checkbox">
                </div>
            </div>
            <div class="cell_tableau2" >
                <div class="sous_cell_banque">
                    <span> Banque BNP</span>
                </div>
                <div class="sous_cell_libelle">
                    <span> Réglement Chèque 35165456 </span>
                </div>
                <div class="sous_cell_type">
                    <span> ANCV - Chèques Vacances</span>
                </div>
                <div class="sous_cell_image">
                    <span> </span>
                </div>
                <div class="sous_cell_montant_debit">
                    <span> 12 000.00</span>
                </div>
                <div class="sous_cell_montant_credit">
              
                </div>
                 <div class="sous_cell_rappro">
                    <input type="checkbox">
                </div>
            </div>
            <div class="cell_tableau2" >
                <div class="sous_cell_banque">
                    <span> Banque BNP</span>
                </div>
                <div class="sous_cell_libelle">
                    <span> Réglement Chèque 35165456 </span>
                </div>
                <div class="sous_cell_type">
                    <span> ANCV - Chèques Vacances</span>
                </div>
                <div class="sous_cell_image">
                    <span> </span>
                </div>
                <div class="sous_cell_montant_debit">
                    <span> 12 000.00</span>
                </div>
                <div class="sous_cell_montant_credit">
              
                </div>
                 <div class="sous_cell_rappro">
                    <input type="checkbox">
                </div>
            </div>
            <div class="cell_tableau2" >
                <div class="sous_cell_banque">
                    <span> Banque BNP</span>
                </div>
                <div class="sous_cell_libelle">
                    <span> Réglement Chèque 35165456 </span>
                </div>
                <div class="sous_cell_type">
                    <span> ANCV - Chèques Vacances</span>
                </div>
                <div class="sous_cell_image">
                    <span> </span>
                </div>
                <div class="sous_cell_montant_debit">
                     <span> 12 000.00</span>
                </div>
                <div class="sous_cell_montant_credit">
              
                </div>
                 <div class="sous_cell_rappro">
                    <input type="checkbox">
                </div>
            </div>
            <div class="cell_tableau2" >
                <div class="sous_cell_banque">
                    <span> Banque BNP</span>
                </div>
                <div class="sous_cell_libelle">
                    <span> Réglement Chèque 35165456 </span>
                </div>
                <div class="sous_cell_type">
                    <span> ANCV - Chèques Vacances</span>
                </div>
                <div class="sous_cell_image">
                   
                </div>
                <div class="sous_cell_montant_debit">
                    <span> 12 000.00</span>
                </div>
                <div class="sous_cell_montant_credit">
              
                </div>
                 <div class="sous_cell_rappro">
                    <input type="checkbox">
                </div>
            </div>
        </div>
        <div class="contenaire_solde">
            <button name="save_submit" class="blue2 save_submit" type="submit">Enregistrer</button>              
            <div class="solde_bottom">
                <div class="solde_theo"> Solde Théorique 
                    <input type="text" class="input_solde" name=""   size="10" maxlength="10"/>
                </div>
                <div class="solde_reel"> Solde Réel 
                    <input type="text" class="input_solde" name=""   size="10" maxlength="10"/>
                </div>
            </div>
            <div class="solde2_bis">
                <div class="solde_debit2"> 
                    <div>
                        <span class="title">Solde Débit</span></div> 
                        <div>
                            <span class="montant">0.00 </span>
                            <span class="euro">€</span>
                        </div> 
                </div><div class="solde_credit2"> 
                        <div>
                            <span class="title">Solde Crédit </span>
                        </div> 
                        <div>
                            <span class="montant">0.00 
                            </span>
                            <span class="euro">€</span>
                        </div> 
                    </div><div class="ecart2"> 
                        <div>
                            <span class="title">Ecart </span>
                        </div> 
                        <div>
                            <span class="montant">0.00 
                            </span>
                            <span class="euro">€</span>
                        </div> 
                        </div>
            </div>
        </div>
</div>
    



	<script>
		var app = opts;
		this.app = opts;
		var _this = this;
		var permissions = app.session.permissions;
		var COMPTA_READ = this.COMPTA_READ = permissions.COMPTA_READ || false;
		var IS_CE = this.IS_CE = permissions.IS_CE || false;
		var IS_ASSO = this.IS_ASSO = permissions.IS_ASSO || false;
		app.on('unmount-parametres', function(){
			app.off('unmount-parametres');
			_this.unmount();
		});

		_this.app.loadScript('/js/admin/elements-manager.js','elements-manager_js', function(){
			_this.E_M = new E_M();

						//_this.E_M.backEndError({error: { code: 1}, tag: _this,});

						if( _this.loaded ){
						}
					});

		this.comptes = [];
		this.idComptes = {};

		function getComptes(){
			var getParams = { type_element: 'compte' };
			if(document.getElementById('id_exercice')){
				getParams.id_exercice = document.getElementById('id_exercice').value;
			}

			$.getJSON( '/admin/compta/comptes', getParams, function(data){
				if(data && data.elements){
					var l = data.elements.length;
					var i, d; 
					var fields = {id: 'id', id_sous_classe: 'id_sous_classe', reference: 'reference', libelle: 'libelle', id_bilan_debit: 'id_bilan_debit', id_bilan_credit: 'id_bilan_credit', categorie_bilan_debit: 'categorie_bilan_debit', categorie_bilan_credit: 'categorie_bilan_credit', id_compte_resultat: 'id_compte_resultat', visible: 'visible',};
					for(i=0; i<l; i++){
						if(data.elements[i]['visible'] == 'visible') {
							d = new Object();

							for(field in fields){
								d[fields[field]] = data.elements[i][field];
							}
							_this.idComptes[d['id']] = i;
							_this.comptes.push(d);
						}
					}
					_this.numToLoad--;
					_this.update();
				}else{
								// TODO: no data elements, get and manage error!...
							}
							_this.numToLoad--;
						})
		}
		getComptes();

		this.elements = [];
		this.idElements = {};

		cancelElement(e){
			if(_this.E_M){
				$('#actions').removeClass('hidden');
				_this.E_M.cancelElement({
					event: e,
					fields: ['id_compte_asso', 'id_compte_fo', 'id_compte_os', 'id_journal_cheques', 'id_journal_especes', 'id_journal_virements', 'id_journal_prelevements', 'id_journal_cartebleue', 'id_journal_chequesvacances', 'id_journal_couponsjeunes', 'id_journal_couponsports', 'id_journal_nouveaux', 'id_journal_paye', 'frais_virements', 'frais_prelevements', 'frais_cartebleue', 'taux_cartebleue', 'prefixe_numero_operations', 'prefixe_numero_pieces', 'banque', 'titulaire', 'rib', 'bic', 'iban'],
					tag: _this,
				});
			}
		}

		saveElement(e){
			if(_this.E_M){
				$('#actions').removeClass('hidden');
				_this.E_M.saveElement({
					event: e, 
					url: '/admin/compta/parametres', 
					fields: ['id_compte_asso', 'id_compte_fo', 'id_compte_os', 'id_journal_cheques', 'id_journal_especes', 'id_journal_virements', 'id_journal_prelevements', 'id_journal_cartebleue', 'id_journal_chequesvacances', 'id_journal_couponsjeunes', 'id_journal_couponsports', 'id_journal_nouveaux', 'id_journal_paye', 'frais_virements', 'frais_prelevements', 'frais_cartebleue', 'taux_cartebleue', 'prefixe_numero_operations', 'prefixe_numero_pieces', 'banque', 'titulaire', 'rib', 'bic', 'iban'],
					tag: _this,
				});
			}
			alert("Enregistré!");
		}

		this.journaux = [];
		this.idJournaux = {};

		function getJournaux(){
			var getParams = { };
			if( _this.selectedExercice ){
				getParams.id_exercice = _this.selectedExercice;
			}else if(document.getElementById('id_exercice')){
				getParams.id_exercice = document.getElementById('id_exercice').value;
			}

			$.getJSON( '/admin/compta/journaux', getParams, function(data){
				//console.log(JSON.stringify(data));
				if(data && data.elements){
					var l = data.elements.length;
					var i, d; 
					var fields = {id: 'id', libelle: 'libelle', visible: 'visible', id_compte: 'id_compte'};
					for(i=0; i<l; i++){
						if(data.elements[i]['visible'] == 'visible') { 
							d = new Object();
										for(field in fields){
											d[fields[field]] = data.elements[i][field];
										}
										_this.idJournaux[d['id']] = i;
										_this.journaux.push(d);
									}
								}
								_this.numToLoad--;
								_this.update();
							}else{
						// TODO: no data elements, get and manage error!...
					}
					_this.numToLoad--;
				})
		}
		getJournaux();

		this.update();

		showContents(e){
			e.preventDefault();
			e.preventUpdate = true;
			if(_this.E_M){
				console.log(e.target);
				_this.E_M.showContents(e);
			}
		};

		this.on('unmount', function(){
				// save browser memory, free event handlers references to permit garbage collect it when the tag will be unmounted!...
				if(_this.E_M){
					_this.E_M.unload(_this);
				}
				cancelElement = null;
				saveElement = null;
			});

		trueCheckbox(e) {
			var id = e.currentTarget.getAttribute("id-for-uncheck");
			var checked = e.currentTarget.checked;
			if (checked == true){
				document.getElementById(id).disabled = false;
			} else {
				document.getElementById(id).disabled = true;
			}
		}

	</script>
</rapprochement>
